; helloos.asm (正确版本)
; 告诉 NASM 汇编器，我们要生成 16 位的代码
BITS 16

; 这部分是 FAT12 软盘的头部信息 (共 136 字节)
db 0xeb, 0x4e, 0x90, 0x48, 0x45, 0x4c, 0x4c, 0x4f
db 0x49, 0x50, 0x4c, 0x00, 0x02, 0x01, 0x01, 0x00
db 0x02, 0xe0, 0x00, 0x40, 0x0b, 0xf0, 0x09, 0x00
db 0x12, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00
db 0x40, 0x0b, 0x00, 0x00, 0x00, 0x00, 0x29, 0xff
db 0xff, 0xff, 0xff, 0x48, 0x45, 0x4c, 0x4c, 0x4f
db 0x2d, 0x4f, 0x53, 0x20, 0x20, 0x20, 0x46, 0x41
db 0x54, 0x31, 0x32, 0x20, 0x20, 0x20, 0x00, 0x00

resb 16 ; 保留 16 字节

; "hello, world" 的机器码
db 0xb8, 0x00, 0x00, 0x8e, 0xd0, 0xbc, 0x00, 0x7c
db 0x8e, 0xd8, 0x8e, 0xc0, 0xbe, 0x74, 0x7c, 0x8a
db 0x04, 0x83, 0xc6, 0x01, 0x3c, 0x00, 0x74, 0x09
db 0xb4, 0x0e, 0xbb, 0x0f, 0x00, 0xcd, 0x10, 0xeb
db 0xee, 0xf4, 0xeb, 0xfd, 0x0a, 0x0a, 0x68, 0x65
db 0x6c, 0x6c, 0x6f, 0x2c, 0x20, 0x77, 0x6f, 0x72
db 0x6c, 0x64, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x00

; ---------------------------------
; 核心修正：使用书中正确的 RESB 值
; 136 (头部) + 368 (填充) + 8 (结尾) = 512 字节
; ---------------------------------
resb 368

; 结尾的 8 个字节，包含 6 个 0x00 和 魔法数字 55 AA
db 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x55, 0xaa

; ---------------------------------
; 启动扇区 (512 字节) 结束
; ---------------------------------

; FAT 表1
db 0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00
resb 4600

; FAT 表2
db 0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00
resb 1469432
